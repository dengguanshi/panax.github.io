{"posts":[{"title":"知识点--dubbo以及RPC","content":"[TOC] 前言 ​ 我们现在维护的项目是ESB和HSF们对于HSF而言，就是我们改造了的dubbo框架,对于dubbo框架,最重要的也是RPC机制,原来公司使用的是ESB＋weblogic+tuxedo+服务一套调用各个服务,esb进行的统一的监控和管控,有较好的容纳性,随着服务的增加和日渐的多样化,定位问题变得更加繁琐,现大部分服务已经使用dubbo框架重写,由esb和zookeeper共同管理,并且基于dubbo的框架,有自己的一套治理中心,我们自己做的监控系统也集成了这个部分,dubbo相比于原来的架构而言,优势就是架构简单易懂,消费者生产者模式,容错性更强,监控运营也更加方便,通过zookeeper的机制随时监控各个服务的状态 RPC 1.理论知识 ​ 我们dubbo和esb的主要功能都是提供RPC服务(Remote ProcedureCall),远程过程调用,服务请求调用,使用HTTP协议就行了,像之前esb使用的就是http协议1.1,使用创建http客户端,发送请求报文到对应的机器上进行处理,但是为啥要替换成RPC了呢,因为针对与http报文传输,使用报文传输是文本编码,并且还有一些无用的头信息以及数据占用空间,比如dubbo的RPC就是使用的是自定义的TCP协议,能够提高传输数据的利用率,并且面对我们日常千万级流量的情况下,还需要一些高级的特性,流量监控,权限控制等等,在传输过程中提高利用率,在使用过程中提高效率,这也是使用RPC的原因 ​ RPC是远程过程调用,调用包括传输协议和序列化协议 传输协议可以是多中,谷歌的grpc是采用http2协议,dubbo使用的是自定义的tcp协议 序列化协议,常见的有基于文本编码的json协议,基于二进制的hessian协议(默认dubbo),esb使用的是webservice(soap文本协议) 2.代码 针对与dubbo,主要的组成部分有,接口,生产者,消费者,zookeeper 针对 那么如何具体实现dubbo框架的运行呢,我们通过编写一个服务的调用来理解框架的运行原理,虽然原来在学习的过程中也有实现过这部分代码,但是原理上并没有理解清楚,dubbo主要运用了Java的动态代理, \\ dubbo 1.理论知识 其核心部分包含: 远程通讯: 提供对多种基于长连接的NIO框架抽象封装，包括多种线程模型，序列化，以及“请求-响应”模式的信息交换方式。 集群容错: 提供基于接口方法的透明远程过程调用，包括多协议支持，以及软负载均衡，失败容错，地址路由，动态配置等集群支持。 自动发现: 基于注册中心目录服务，使服务消费方能动态的查找服务提供方，使地址透明，使服务提供方可以平滑增加或减少机器。 2.运维知识 dubbo+zookeeper模拟宕机后问题复现及解决办法-白红宇的个人博客 (css8.cn) 当zk集群超过半数宕机后，之前的服务都能正常使用，通过缓存取的服务信息 当zk集群超过半数宕机后，新的服务无法发布到集群中 当集群重新启动后，zk可以自动重连，但是消费者会在一段时间后报错，无法找到提供者，必须重启提供者才行，消费者不需要重启。 ","link":"https://myhomeme.github.io/DOiWDaLRj/"},{"title":"ADevOps分享","content":"[TOC] 背景 本站用于分享开发运维常用工具网站，分享本人工作生产 ","link":"https://myhomeme.github.io/adevops-fen-xiang/"}]}